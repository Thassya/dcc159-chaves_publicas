package chavespublicas;

import java.math.BigInteger;

public class RSA {

    private final int bitlen = 2048;
    private final BigInteger p = new BigInteger("125771293470574016222657442880579349923102301422680301996293861904889176245247237474549771613478658843332301742852009035175415879454102747178102114134452329201991024346708317882175818793469085869469143738360678983817765244826169548877898409522498033296877865723455109719955509876157880858081965400020459552563");
    private final BigInteger q = new BigInteger("172889496560741365576871446002397788788625284858883454024628739451338619724745236729677783488369397366954646396369773103488231573561747465974632421861547984372717079063389289821694348833955002160788579121694641527481983528604262477174046934354063780457066955941681855679930667115075346935575806716564790026743");
    private final BigInteger n = new BigInteger("21744535609920799346490198200459194630284892222794680307957666138290132451463404387817099672984428302212187809786053812403430511738945976312083969886937585817953809566424308219361637985223469234908676241196680792159602850150089418389982078543734469484192485324577366842397349851663076198864242615239131559935708003641570218025563459191981443568781642198298028641982322189168369738539011544254151335355636395751951891968241929873438557819826969012260752133706948350952963121252969159842177745428713476993299434556991927215611197472409336934999848814596299515228581028996096397839437334059821618140686456547206584192309");
    private final BigInteger e = new BigInteger("5");
    private final BigInteger d = new BigInteger("4348907121984159869298039640091838926056978444558936061591533227658026490292680877563419934596885660442437561957210762480686102347789195262416793977387517163590761913284861643872327597044693846981735248239336158431920570030017883677996415708746893896838497064915473368479469970332615239772848523047826311987081868570307780528752786060619693286013982922403292977192279917562428388513803814009984756050757667908332988765804029546954982073362223759821603519542189607475651003568574310427661515560257877792608342339387321340862289739795780981789580694143947540294927241466191886487910231413717678069405736886124266922601");

    public String rsa_encrypt(String msg){
        String msgcifrada = new BigInteger(msg.getBytes()).modPow(e, n).toString();
        //System.out.println("msg cifrada: "+ msgcifrada);
        return msgcifrada;
    }

    public String rsa_decrypt(String msgcifrada){
        String msgdecifrada = new String(new BigInteger(msgcifrada).modPow(d, n).toByteArray());
        //System.out.println("msg decifrada: " +msgdecifrada);
        return msgdecifrada;
    }
}
